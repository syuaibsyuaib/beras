<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.13.2/b-2.3.4/b-html5-2.3.4/date-1.3.0/datatables.min.css" />
    <style>

    </style>
</head>

<body>
    <div class="container-sm">
        <div>
            <h1>Hitung Beras</h1>
        </div>

        <!-- tabs -->
        <div class="d-none d-md-block mb-3">
            <nav>
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <button class="nav-link active nota" data-bs-toggle="tab" data-bs-target="#pills-nota"
                            type="button" role="tab" aria-controls="pills-nota" aria-selected="true">Nota</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link masuk" data-bs-toggle="tab" data-bs-target="#pills-barang-masuk"
                            type="button" role="tab" aria-controls="pills-barang-masuk" aria-selected="false">T.B.
                            Masuk</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link keluar" data-bs-toggle="tab" data-bs-target="#pills-barang-keluar"
                            type="button" role="tab" aria-controls="pills-barang-keluar" aria-selected="false">T.B.
                            Keluar</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link produksi" data-bs-toggle="tab" data-bs-target="#pills-produksi-beras"
                            type="button" role="tab" aria-controls="pills-produksi-beras" aria-selected="false">Produksi
                            Beras</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link atur" data-bs-toggle="tab" data-bs-target="#pills-atur" type="button"
                            role="tab" aria-controls="pills-atur" aria-selected="false">Pengaturan</button>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- navbar -->
        <div class="d-md-none mb-5">
            <nav class="navbar navbar-dark bg-dark fixed-top">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">Hitung Beras</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasDarkNavbar"
                        aria-labelledby="offcanvasDarkNavbarLabel">
                        <div class="offcanvas-header">
                            <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">Menu</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                                aria-label="Close"></button>
                        </div>
                        <div class="offcanvas-body">
                            <div>
                                <ul class="nav justify-content-end flex-grow-1 pe-3 d-block">
                                    <li class="nav-item border-bottom">
                                        <a class="nav-link active nota" data-bs-toggle="tab"
                                            data-bs-target="#pills-nota" type="button" role="button"
                                            aria-controls="pills-nota" aria-selected="true">Nota</a>
                                    </li>
                                    <li class="nav-item border-bottom">
                                        <a class="nav-link masuk" data-bs-toggle="tab"
                                            data-bs-target="#pills-barang-masuk" type="button" role="button"
                                            aria-controls="pills-barang-masuk" aria-selected="false">T.B. Masuk</a>
                                    </li>
                                    <li class="nav-item border-bottom">
                                        <a class="nav-link keluar" data-bs-toggle="tab"
                                            data-bs-target="#pills-barang-keluar" type="button" role="button"
                                            aria-controls="pills-barang-keluar" aria-selected="false">T.B. Keluar</a>
                                    </li>
                                    <li class="nav-item border-bottom">
                                        <a class="nav-link produksi" data-bs-toggle="tab"
                                            data-bs-target="#pills-produksi-beras" type="button" role="button"
                                            aria-controls="pills-produksi-beras" aria-selected="false">Produksi
                                            Beras</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link atur" data-bs-toggle="tab" data-bs-target="#pills-atur"
                                            type="button" role="button" aria-controls="pills-atur"
                                            aria-selected="false">Pengaturan</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </div>

        <!-- konten -->
        <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-nota" role="tabpanel" aria-labelledby="pills-nota-tab"
                tabindex="0">
                <div class="row mb-3">
                    <div class="col-2">
                        <button type="button" class="btn btn-success" data-bs-toggle="modal"
                            data-bs-target="#tambahItem">Tambah</button>
                    </div>
                    <div class="col">
                        NOTA
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tabel_nota" class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>No. Polisi</th>
                                <th>Nama Pelanggan</th>
                                <th>Merek</th>
                                <th>Qty</th>
                                <th>Tipe Kg</th>
                                <th>Jumlah</th>
                                <th>Harga</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-barang-masuk" role="tabpanel" aria-labelledby="pills-barang-masuk-tab"
                tabindex="0">
                <div class="row mb-3">
                    <div class="col-2">
                        <button type="button" class="btn btn-success" data-bs-toggle="modal"
                            data-bs-target="#tambahItem">Tambah</button>
                    </div>
                    <div class="col">
                        T.B. MASUK
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tabel_barang_masuk" class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>No. Polisi</th>
                                <th>Supplier</th>
                                <th>Timbangan Masuk (kg)</th>
                                <th>Timbangan Keluar (kg)</th>
                                <th>Timbangan Bersih (kg)</th>
                                <th>Potongan</th>
                                <th>Timbangan Lokasi</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-barang-keluar" role="tabpanel"
                aria-labelledby="pills-barang-keluar-tab" tabindex="0">
                <div class="row mb-3">
                    <div class="col-2">
                        <button type="button" class="btn btn-success" data-bs-toggle="modal"
                            data-bs-target="#tambahItem">Tambah</button>
                    </div>
                    <div class="col">
                        T.B. KELUAR
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tabel_barang_keluar" class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>No. Polisi</th>
                                <th>Nama Pelanggan</th>
                                <th>Timbangan Masuk</th>
                                <th>Timbangan Keluar</th>
                                <th>Timbangan Bersih</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-produksi-beras" role="tabpanel"
                aria-labelledby="pills-produksi-beras-tab" tabindex="0">
                <div class="row mb-3">
                    <div class="col-2">
                        <button type="button" class="btn btn-success" data-bs-toggle="modal"
                            data-bs-target="#tambahItem">Tambah</button>
                    </div>
                    <div class="col">
                        PRODUKSI
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tabel_produksi" class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Merek</th>
                                <th>Qty</th>
                                <th>Tipe Kg</th>
                                <th>Jumlah Produksi</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-atur" role="tabpanel" aria-labelledby="pills-produksi-beras-tab"
                tabindex="0">
                <div class="row mb-3">
                    <div class="col-2">
                        <button type="button" class="btn btn-success" data-bs-toggle="modal"
                            data-bs-target="#tambahItem">Tambah</button>
                    </div>
                    <div class="col">
                        Pengaturan
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tabel_atur" class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Merek</th>
                                <th>Tipe Kg</th>
                                <th>Harga Satuan</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="tambahItem" tabindex="-1" aria-labelledby="tambahItemLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="tambahItemLabel">Tambah Item</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        ...
                    </div>
                    <!-- <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div> -->
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.js"
        integrity="sha512-nO7wgHUoWPYGCNriyGzcFwPSF+bPDOR+NvtOYy2wMcWkrnCNPKBcFEkU80XIN14UVja0Gdnff9EmydyLlOL7mQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
    <script type="text/javascript"
        src="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.13.2/b-2.3.4/b-html5-2.3.4/date-1.3.0/datatables.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#tabel_nota').DataTable({
                search: {
                    return: true,
                },
            });

            $('#tabel_barang_masuk').DataTable({
                search: {
                    return: true,
                },
            });

            $('#tabel_barang_keluar').DataTable({
                search: {
                    return: true,
                },
            });

            $('#tabel_produksi').DataTable({
                search: {
                    return: true,
                },
            });

            $('#tabel_atur').DataTable({
                search: {
                    return: true,
                },
            });

        });

        let templateFormNota =
            `
        <form id="form_nota">
            <div class="mb-3">
                <label for="nomor_polisi_nota" class="form-label">Nomor Polisi</label>
                <input type="text" class="form-control" id="nomor_polisi_nota" name="nomor_polisi_nota">
            </div>
            <div class="mb-3">
                <label for="nama_costumer" class="form-label">Nama Costumer</label>
                <input type="text" class="form-control" id="nama_costumer" name="nama_costumer_nota">
            </div>
            <div class="mb-3">
                <label class="form-label">Merek</label>
                <select class="form-select" aria-label="Default select example" id="merek" name="merek_nota">
                    <option value="Mawar" selected>Mawar</option>
                    <option value="Jempol">Jempol</option>
                    <option value="Bambu">Bambu</option>
                    <option value="Melati">Melati</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="quantity" class="form-label">Quantity</label>
                <input type="number" class="form-control" id="quantity" name="quantity_nota">
            </div>
            <div class="mb-3">
                <label class="form-label">Jenis KG</label>
                <select class="form-select" aria-label="Default select example" name="jenis_kg_nota">
                    <option value="5" selected>5</option>
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="harga_nota" class="form-label">Harga</label>
                <input type="number" class="form-control" id="harga_nota" name="harga_nota" readonly>
            </div>
            <div class="mb-3">
                <label for="total_nota" class="form-label">Total</label>
                <input type="text" class="form-control" id="total_nota" name="total_nota" readonly>
            </div>
            <div class="text-end">
                <button type="submit" class="btn btn-primary">Simpan</button>
            </div>
        </form>
        `

        let templateFormMasuk =
            `
        <form>
            <div class="mb-3">
                <label for="nomor_polisi_masuk" class="form-label">Nomor Polisi</label>
                <input type="text" class="form-control" id="nomor_polisi_masuk" name="nomor_polisi_masuk">
            </div>
            <div class="mb-3">
                <label for="nama_supplier_masuk" class="form-label">Nama Supplier</label>
                <input type="text" class="form-control" id="nama_supplier_masuk" name="nama_supplier_masuk">
            </div>
            <div class="mb-3">
                <label for="tb_masuk_masuk" class="form-label">Tb. Masuk (Kg)</label>
                <input type="text" class="form-control" id="tb_masuk_masuk" name="tb_masuk_masuk">
            </div>
            <div class="mb-3">
                <label for="tb_keluar_masuk" class="form-label">Tb. Keluar (Kg)</label>
                <input type="text" class="form-control" id="tb_keluar_masuk" name="tb_keluar_masuk">
            </div>
            <div class="mb-3">
                <label for="potongan_masuk" class="form-label">Potongan (Kg)</label>
                <input type="text" class="form-control" id="potongan_masuk" name="potongan_masuk">
            </div>
            <div class="mb-3">
                <label for="tb_lokasi_masuk" class="form-label">Tb. Lokasi (Kg)</label>
                <input type="text" class="form-control" id="tb_lokasi_masuk" name="tb_lokasi_masuk">
            </div>

            <div class="text-end">
                <button type="submit" class="btn btn-primary">Simpan</button>
            </div>
        </form>
        `

        let templateFormKeluar =
            `
        <form>
            <div class="mb-3">
                <label for="nomor_polisi_keluar" class="form-label">Nomor Polisi</label>
                <input type="text" class="form-control" id="nomor_polisi_keluar" name="nomor_polisi_keluar">
            </div>
            <div class="mb-3">
                <label for="nama_costumer_keluar" class="form-label">Nama Costumer</label>
                <input type="text" class="form-control" id="nama_costumer_keluar" name="nama_costumer_keluar">
            </div>
            <div class="mb-3">
                <label for="tb_masuk_keluar" class="form-label">Tb. Masuk (Kg)</label>
                <input type="text" class="form-control" id="tb_masuk_keluar" name="tb_masuk_keluar">
            </div>
            <div class="mb-3">
                <label for="tb_keluar_keluar" class="form-label">Tb. Keluar (Kg)</label>
                <input type="text" class="form-control" id="tb_keluar_keluar" name="tb_keluar_keluar">
            </div>
            <div class="mb-3">
                <label for="tb_bersih_keluar" class="form-label">Tb. Bersih (Kg)</label>
                <input type="text" class="form-control" id="tb_bersih_keluar" name="tb_bersih_keluar">
            </div>

            <div class="text-end">
                <button type="submit" class="btn btn-primary">Simpan</button>
            </div>
        </form>
        `

        let templateFormProduksi =
            `
        <form>
            <div class="mb-3">
                <label for="nomor_polisi_produksi" class="form-label">Nomor Polisi</label>
                <input type="text" class="form-control" id="nomor_polisi_produksi" name="nomor_polisi_produksi">
            </div>
            <div class="mb-3">
                <label class="form-label">Merek</label>
                <select class="form-select" aria-label="Default select example" id="merek" name="merek">
                    <option value="Mawar" selected>Mawar</option>
                    <option value="Jempol">Jempol</option>
                    <option value="Bambu">Bambu</option>
                    <option value="Melati">Melati</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="quantity_produksi" class="form-label">Quantity</label>
                <input type="number" class="form-control" id="quantity_produksi" name="quantity_produksi">
            </div>
            <div class="mb-3">
                <label class="form-label">Jenis KG</label>
                <select class="form-select" aria-label="Default select example" name="jenis_kg_produksi">
                    <option value="5" selected>5</option>
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="jumlah_produksi" class="form-label">Jumlah</label>
                <input type="number" class="form-control" id="jumlah_produksi" name="jumlah_produksi">
            </div>

            <div class="text-end">
                <button type="submit" class="btn btn-primary">Simpan</button>
            </div>
        </form>
        `

        const myModalEl = document.getElementById('tambahItem')
        myModalEl.addEventListener('show.bs.modal', event => {
            let idTombol = $(event.relatedTarget).parents().eq(2).attr('id')

            switch (idTombol) {
                case 'pills-nota':
                    // toggleActiveNav('.nota')
                    $('#tambahItem .modal-body').html(templateFormNota)
                    console.log(kirimForm())
                    break;
                case 'pills-barang-masuk':
                    // toggleActiveNav('.masuk')
                    $('#tambahItem .modal-body').html(templateFormMasuk)
                    kirimForm()
                    break;
                case 'pills-barang-keluar':
                    // toggleActiveNav('.keluar')
                    $('#tambahItem .modal-body').html(templateFormKeluar)
                    kirimForm()
                    break;
                case 'pills-produksi-beras':
                    // toggleActiveNav('.produksi')
                    $('#tambahItem .modal-body').html(templateFormProduksi)
                    kirimForm()
                    break;
            }
        })

        // function toggleActiveNav(cls) {
        //     $('nav').find('.active').filter(function (ind, e) {
        //         $(e).removeClass('active')
        //     })

        //     $('nav').find(cls).filter(function (ind, e) {
        //         $(e).addClass('active')
        //     })
        // }

        function kirim(data) {
            let url = 'https://script.google.com/macros/s/AKfycbxZWZpNC1OuwuN1xEPrVtc_jWJ035s-F8BZvUpsVALOijZRTROsW_Rm0NHZzb_W6fNE/exec'
            return fetch(url, {
                method: 'post',
                body: JSON.stringify(data)
            }).then(res => {
                return res.json()
            })
        }

        function kirimForm() {
            $('form').submit(function (e) {
                e.preventDefault()
                let hasil = kirim($(this).serializeArray())
                return hasil.then(resp => {
                    // $('#tabel_nota')
                    return JSON.parse(resp.sukses)
                })
            })
        }

    </script>
</body>

</html>